<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>MTN TV App</title>
  <!-- Meta tags for proper character encoding and responsiveness -->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Page Title -->
    <title> MTN TV App </title>

    <!-- Open Graph Meta Tags for link preview -->
    <meta property="og:title" content="MTN TV App" />
    <meta property="og:description" content="تمتع بمتابعة مسلسلاتك التلفزيونية والأفلام والمباريات الرياضية مع مجموعة كبيرة من القنوات التلفزيونية العربية والعالمية بالإضافة للكثير من الفيديوهات بدقة عالية جداً." />
    
    <!-- Important: Full URL to the image for preview -->
    <meta property="og:image" content="https://res.cloudinary.com/dpdeknzho/image/upload/v1728570722/IMG_20241010_173113_519_iydavb.jpg" />
    
    <!-- Optional but recommended: specify image dimensions -->
    <meta property="og:image:width" content="1200" />
    <meta property="og:image:height" content="630" />

    <!-- The actual URL of the page being shared -->
    <meta property="og:url" content="https://res.cloudinary.com/dpdeknzho/image/upload/v1728570722/IMG_20241010_173113_519_iydavb.jpg" />
    
    <!-- Website type -->
    <meta property="og:type" content="website" />

    <!-- Optional: Name of the website or app -->
    <meta property="og:site_name" content="MTN SYR" />

    <!-- Optional: Twitter Card tags if you'd like a Twitter-specific preview -->
    <meta name="twitter:card" content="large_image">
    <meta name="twitter:title" content="MTN TV App">
    <meta name="twitter:description" content="تمتع بمتابعة مسلسلاتك التلفزيونية والأفلام والمباريات الرياضية مع مجموعة كبيرة من القنوات التلفزيونية العربية والعالمية بالإضافة للكثير من الفيديوهات بدقة عالية جداً.">
    <meta name="twitter:image" content="https://res.cloudinary.com/dpdeknzho/image/upload/v1728570722/IMG_20241010_173113_519_iydavb.jpg">
    
  <!-- reCAPTCHA v3 client script (replace YOUR_SITE_KEY) -->
  <script src="https://www.google.com/recaptcha/api.js?render=6Lez18QrAAAAAHRVudPm3hSQZMkAlFN-2ilGylQP"></script>
</head>
<body>
  <p id="status">Preparing download…</p>

  <script>
    const SITE_KEY = '6Lez18QrAAAAAHRVudPm3hSQZMkAlFN-2ilGylQP'; // <--- put your site key here
    const WORKER_URL = 'https://recabachav3.digitalservices-mtn.workers.dev/'; // <--- change to your Worker URL
    const DOWNLOAD_URL = 'https://github.com/DevDigitalMTN/testreCabatcha/releases/download/mtnTV/Mazaji_MTNTV_v4.0.2.apk'

    const statusEl = document.getElementById('status');
    function setStatus(t){ statusEl.textContent = t; }

    grecaptcha.ready(() => {
      setStatus('Running security check...');
      // action 'download' is an arbitrary label — we'll expect the same on server
      grecaptcha.execute(SITE_KEY, { action: 'download' }).then(token => {
        // send token to Cloudflare Worker for server-side verification
        fetch(WORKER_URL, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ token, action: 'download' })
        })
        .then(r => r.json())
        .then(json => {
          if (json.success) {
            setStatus('Verified ✓ Redirecting to download...');
            // short delay to show message then redirect
            setTimeout(() => window.location.href = DOWNLOAD_URL, 300);
          } else {
            console.warn('reCAPTCHA failed', json);
            setStatus('Verification failed. Try again later.');
            // optionally show a manual link or retry button
          }
        })
        .catch(err => {
          console.error(err);
          setStatus('Network or server error during verification.');
        });
      });
    });
  </script>
</body>
</html>
